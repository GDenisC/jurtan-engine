{"version":3,"file":"instance.js","sourceRoot":"je-src/","sources":["instance.ts"],"names":[],"mappings":"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","sourcesContent":["import { Point, Rect } from \"./math.js\";\nimport { Canvas, getCanvasInstance } from \"./canvas.js\";\nimport { AnyColor, Color } from \"./colors.js\";\nimport { ChildrenArray } from \"./childrenArray.js\";\nimport { GameMath, Radians, Angle } from \"./math.js\";\n\nlet lastInstanceId = 0;\nlet canvasInstance: Canvas | null = null;\n\nexport interface Rectable {\n    get rect(): Rect;\n}\n\nexport type DrawDirection = 'top-left' | 'top' | 'top-right' | 'left' | 'center' | 'right' | 'bottom-left' | 'bottom' | 'bottom-right';\n\nexport abstract class Instance extends ChildrenArray<Instance> {\n    private firstUpdate = false;\n    protected dontTranslate = false;\n    protected drawChildBottom = true;\n    /**\n     * Note: dont affect to text\n     */\n    drawDirection: DrawDirection = 'center';\n    index: number;\n    depth = 0;\n    x = 0;\n    y = 0;\n    clipStroke = false;\n\n    constructor() {\n        super();\n        this.index = ++lastInstanceId;\n        this.onCreate();\n    }\n\n    onCreate() {}\n    onBegin() {}\n    onDestroy() {}\n\n    onUpdate() {}\n\n    onDraw() {}\n\n    _update(ctx: CanvasRenderingContext2D) {\n        const children = [...this.children]; // copy array\n        const updateChildren = () => children.sort((a, b) => a.depth - b.depth).forEach(child => child._update(ctx));\n        ctx.save();\n        this.onUpdate();\n        if (!this.dontTranslate) ctx.translate(this.x, this.y);\n        if (!this.firstUpdate) {\n            this.onBegin();\n            this.firstUpdate = true;\n        }\n        if (this.drawChildBottom) updateChildren();\n        this.onDraw();\n        if (!this.drawChildBottom) updateChildren();\n        ctx.restore();\n    }\n\n    translate(x: number, y: number) {\n        this.ctx.translate(x, y);\n    }\n\n    rotate(radians: Radians) {\n        this.ctx.rotate(radians);\n    }\n\n    rotateAngle(angle: Angle) {\n        this.rotate(GameMath.toRadians(angle));\n    }\n\n    scale(x: number, y: number) {\n        this.ctx.scale(x, y);\n    }\n\n    save() {\n        this.ctx.save();\n    }\n\n    restore() {\n        this.ctx.restore();\n    }\n\n    get lineWidth() {\n        return this.ctx.lineWidth;\n    }\n\n    set lineWidth(w: number) {\n        this.ctx.lineWidth = w;\n    }\n\n    set fontAlign(align: CanvasTextAlign) {\n        this.ctx.textAlign = align;\n    }\n\n    private setColor(prop: 'fillStyle' | 'strokeStyle', c: AnyColor) {\n        this.ctx[prop] = typeof c == 'string' ? c : Array.isArray(c) ? Color.from(c[0], c[1], c[2], c[3]) : Color.convert(c);\n    }\n\n    set fillColor(c: AnyColor) {\n        this.setColor('fillStyle', c);\n    }\n\n    set strokeColor(c: AnyColor) {\n        this.setColor('strokeStyle', c);\n    }\n\n    set fontBaseline(baseline: CanvasTextBaseline) {\n        this.ctx.textBaseline = baseline;\n    }\n\n    set font(font: string) {\n        this.ctx.font = font;\n    }\n\n    protected getDirection(x: number, y: number, w: number, h: number, direction: DrawDirection = this.drawDirection) {\n        const dir: Record<DrawDirection, [number, number]> = {\n            'top-left': [x, y],\n            'top': [x + w / 2, y],\n            'top-right': [x + w, y],\n            'left': [x, y + h / 2],\n            'center': [x + w / 2, y + h / 2],\n            'right': [x + w, y + h / 2],\n            'bottom-left': [x, y + h],\n            'bottom': [x + w / 2, y + h],\n            'bottom-right': [x + w, y + h],\n        };\n        return dir[direction];\n    }\n\n    rectangle(x: number, y: number, width: number, height: number) {\n        this.ctx.beginPath();\n        this.ctx.rect(...this.getDirection(x, y, width, height), width, height);\n        this.ctx.closePath();\n    }\n\n    roundRect(x: number, y: number, width: number, height: number, radius: number) {\n        this.ctx.beginPath();\n        this.ctx.roundRect(...this.getDirection(x, y, width, height), width, height, radius);\n        this.ctx.closePath();\n    }\n\n    circle(x: number, y: number, radius: number) {\n        this.ctx.beginPath();\n        this.ctx.arc(x, y, radius, 0, 2 * Math.PI);\n        this.ctx.closePath();\n    }\n\n    path(vertexes: Point[], closePath = true) {\n        this.ctx.beginPath();\n        this.ctx.moveTo(vertexes[0].x, vertexes[0].y);\n        for (let i = 1; i < vertexes.length; i++) {\n            this.ctx.lineTo(vertexes[i].x, vertexes[i].y);\n        }\n        if (closePath) this.ctx.closePath();\n    }\n\n    polygon(angles: number, { scale, radians }: Partial<{ scale: number, radians: Radians }>) {\n        scale ??= 1;\n        radians ??= 0;\n        const theta = 2 * Math.PI / angles;\n        this.path(\n            Array.from({ length: angles }, (_, i) => new Point(\n                Math.cos(i * theta + (radians as number) / 180 * Math.PI) * (scale as number),\n                Math.sin(i * theta + (radians as number) / 180 * Math.PI) * (scale as number)\n            ))\n        );\n    }\n\n    fill(): void;\n    fill(color: AnyColor): void;\n    fill(color?: AnyColor) {\n        if (color) this.fillColor = color;\n        this.ctx.fill();\n    }\n\n    stroke(): void;\n    stroke(color: AnyColor): void;\n    stroke(color?: AnyColor) {\n        if (color) this.strokeColor = color;\n        if (this.clipStroke) {\n            this.save();\n            {\n                this.lineWidth *= 2;\n                this.ctx.clip();\n                this.ctx.stroke();\n                this.lineWidth /= 2;\n            }\n            this.restore();\n        } else {\n            this.ctx.stroke();\n        }\n    }\n\n    fillText(x: number, y: number, ...text: any[]) {\n        this.ctx.fillText(text.join(' '), x, y);\n    }\n\n    strokeText(x: number, y: number, ...text: any[]) {\n        this.ctx.strokeText(text.join(' '), x, y);\n    }\n\n    drawImage(image: HTMLImageElement, x: number, y: number, width: number, height: number) {\n        this.ctx.drawImage(image, ...this.getDirection(x, y, width, height), width, height);\n    }\n\n    /**\n     * @param value Alpha value from 0 to 1 (decimal).\n     */\n    set alpha(value: number) {\n        this.ctx.globalAlpha = value;\n    }\n\n    measureText(...text: any[]) {\n        return this.ctx.measureText(text.join(' '));\n    }\n\n    destroy(cleanup = true) {\n        this.onDestroy();\n        if (cleanup) this.children.forEach(child => child.destroy());\n        if (this.parent == null) {\n            this.canvas.instances.splice(this.canvas.instances.indexOf(this), 1);\n        } else {\n            this.parent.removeChild(this, false);\n        }\n    }\n\n    getRect(width: number, height: number, direction: DrawDirection = 'center') {\n        const { pos } = this;\n        return new Rect(...this.getDirection(pos.x, pos.y, width, height, direction), width, height);\n    }\n\n    isChildOf(parentClass: FunctionConstructor): boolean {\n        if (this.parent == null) return false;\n        if (this.parent instanceof parentClass) return true;\n        return this.parent.isChildOf(parentClass);\n    }\n\n    isClassOf(...instancesClasses: FunctionConstructor[]) {\n        for (const cls of instancesClasses) {\n            if (this instanceof cls)\n                return true;\n        }\n        return false;\n    }\n\n    addToMain() {\n        this.canvas.add(this);\n    }\n\n    get pos() {\n        const parent = this.parent ? this.parent.pos : new Point(0, 0);\n        return new Point(this.x + parent.x, this.y + parent.y);\n    }\n\n    set pos(p: Point) {\n        this.x = p.x;\n        this.y = p.y;\n    }\n\n    get canvas() {\n        if (!canvasInstance) canvasInstance = getCanvasInstance();\n        return canvasInstance;\n    }\n\n    get ctx() {\n        return this.canvas.ctx;\n    }\n}"]}